<div id='bibliography_translators' class='repeatable-field'>
    <div class="fields">
        <%= form.simple_fields_for :translators do |peep| %>
            <%= peep.association :person, 
                label: field_label,
                collection: [Person.find_by_id(peep.object.person_id)],
                prompt: 'Choose a ' + field_label,
                form_name: 'peep',
                input_html: {
                    class: 'translators', 
                    "data-url": citationterms_search_path
                }
            %>
        <% end %>
    </div>
    <div id="bibliography_translator_suggestions">
        <%= form.simple_fields_for :person_suggestions do |suggestion| %>
            <% if suggestion.object.field_name == 'translator' %>
                <%= render 'suggest_person_fields', :form => suggestion, fieldname: 'translator' %>
             <% end %>   
        <% end %>
    </div>
    <div class='links clearfix'>
        <div class="col-sm-2"></div>
        <div class="col-sm-10 btn-add-container">
            <%= link_to_add_association Bibliography::ADD_BUTTON + field_label, 
                form, 
                :translators, 
                class: 'btn btn-warning btn-add fa-icon', 
                form_name: 'form', 
                data: {
                    'association-insertion-node' => '#bibliography_translators .fields', 
                    'association-insertion-method' => 'append'
                },
                partial: 'person_fields',
                render_options:  {
                    locals: { 
                        prompt_label: 'Choose a ' + field_label, 
                        class_name: 'translators' 
                    }
                }
            %>
            <%= link_to_add_association 'Suggest a new '  + field_label, 
                form, 
                :person_suggestions, 
                class: 'btn btn-warning btn-add', 
                form_name: 'form',
                data: {
                    'association-insertion-node' => '#bibliography_translator_suggestions', 
                    'association-insertion-method' => 'append'
                }, 
                partial: 'suggest_person_fields',
                render_options: {locals: {fieldname: 'translator'}}
            %>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    $('.translators').select2( select2_config(".translators", "people") );
    $("#bibliography_translators").on('cocoon:after-insert', function(e, insertedItem){
        $('.translators').last().select2( select2_config(".translators", "people") );
    });
});
</script>